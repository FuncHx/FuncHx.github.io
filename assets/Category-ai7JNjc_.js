import"./index-YMm1u_MW.js";import"./index-mA40pxaD.js";import{a as A,S as L}from"./category-BTJuZUL9.js";import{N as q}from"./index-D7FwJdV1.js";import{_ as G,j as F,r as f,g as M,f as _,k as s,c as v,s as o,F as g,q as y,u as P,l as r,y as R,A as h,x as U}from"./index-B9rkyR3d.js";import"./index-B9ygI19o.js";const $={class:"category-page"},j={class:"category-container"},z={class:"search-wrap"},D={class:"body"},E={class:"platforms"},H=["onClick"],J=["src"],K={class:"plat-name"},O={class:"games"},Q={class:"games-grid"},T=["onClick"],W=["src"],X={__name:"Category",setup(Y){const k=F(),C=P(),m=k.params.id,l=A(),c=f(""),n=f(null),p=f("");M(async()=>{await l.fetchCategories();const e=l.getById(Number(m))||l.categories[0];console.log(e,m),p.value=e?e.name:"分类列表",e&&Array.isArray(e.platforms)&&e.platforms.length&&(n.value=e.platforms[0].platformId)});const i=_(()=>l.getById(Number(m))||l.categories.find(e=>String(e.categoryId)===String(m))),I=_(()=>i.value&&i.value.platforms||[]);function w(){return!i.value||!Array.isArray(i.value.platforms)?[]:i.value.platforms.flatMap(e=>(e.games||[]).map(a=>({...a,platformId:e.platformId})))}const b=_(()=>{const e=w();let a=e;if(n.value!==null&&n.value!==void 0&&(a=e.filter(u=>u.platformId===n.value)),c.value&&c.value.trim()){const u=c.value.trim().toLowerCase();a=a.filter(d=>(d.name||"").toLowerCase().includes(u))}return a});function B(e){n.value=e}function N(e){return e?/^https?:\/\//i.test(e)?e:"https://"+e:""}function S(e){const a=N(e.toLink||e.link||"");a&&window.open(a,"_blank")}function V(){C.back()}return(e,a)=>{const u=q,d=L;return r(),s("div",$,[v(u,{title:p.value,"left-text":"返回","left-arrow":"",onClickLeft:V},null,8,["title"]),o("div",j,[o("div",z,[v(d,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value=t),placeholder:"搜索游戏/平台","show-action":""},null,8,["modelValue"])]),o("div",D,[o("aside",E,[o("ul",null,[(r(!0),s(g,null,y(I.value,t=>(r(),s("li",{key:t.platformId??t.name,class:R({active:t.platformId===n.value}),onClick:x=>B(t.platformId)},[t.icon?(r(),s("img",{key:0,src:t.icon,alt:"",class:"plat-icon"},null,8,J)):h("",!0),o("div",K,U(t.name),1)],10,H))),128))])]),o("section",O,[o("div",Q,[(r(!0),s(g,null,y(b.value,t=>(r(),s("div",{class:"game-card",key:(t.platformId??"")+"_"+(t.gameId??t.name),onClick:x=>S(t)},[t.icon?(r(),s("img",{key:0,src:t.icon,alt:"",class:"game-icon"},null,8,W)):h("",!0)],8,T))),128))])])])])])}}},re=G(X,[["__scopeId","data-v-f63b138c"]]);export{re as default};
